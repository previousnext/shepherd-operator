apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  creationTimestamp: null
  labels:
    controller-tools.k8s.io: "1.0"
  name: drupals.app.skpr.io
spec:
  group: app.skpr.io
  names:
    kind: Drupal
    plural: drupals
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      properties:
        apiVersion:
          description: 'APIVersion defines the versioned schema of this representation
            of an object. Servers should convert recognized schemas to the latest
            internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/api-conventions.md#resources'
          type: string
        kind:
          description: 'Kind is a string value representing the REST resource this
            object represents. Servers may infer this from the endpoint the client
            submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/api-conventions.md#types-kinds'
          type: string
        metadata:
          type: object
        spec:
          properties:
            backup:
              description: Backup configuration for recovery.
              properties:
                schedule:
                  type: string
              required:
              - schedule
              type: object
            configmap:
              description: Configuration which is exposed to the Drupal application
                eg. database hostname.
              properties:
                default:
                  description: Configuration which is automatically set.
                  properties:
                    path:
                      description: Path which the configuration will be mounted.
                      type: string
                  required:
                  - path
                  type: object
                override:
                  description: Configuration which is user provided.
                  properties:
                    path:
                      description: Path which the configuration will be mounted.
                      type: string
                  required:
                  - path
                  type: object
              required:
              - default
              - override
              type: object
            cron:
              description: Background tasks which are executed periodically eg. "drush
                cron"
              type: object
            exec:
              description: Configuration for the Execution environment eg. image /
                resources / timeout.
              properties:
                image:
                  description: Image which will be used for developer command line
                    access.
                  type: string
                readOnly:
                  description: Marks the filesystem as readonly to ensure code cannot
                    be changed.
                  type: boolean
                resources:
                  description: Resource constraints which will be applied to the background
                    task.
                  type: object
                timeout:
                  description: How long for the command line environment to exist.
                  format: int64
                  type: integer
              required:
              - image
              - readOnly
              - resources
              - timeout
              type: object
            fpm:
              description: Configuration for the FPM deployment eg. image / resources
                / scaling.
              properties:
                autoscaling:
                  description: Autoscaling rules which will be applied to the deployment.
                  properties:
                    replicas:
                      description: How many copies of the deployment which should
                        be running.
                      properties:
                        max:
                          description: Maximum number of replicas for the deployment.
                          format: int32
                          type: integer
                        min:
                          description: Minimum number of replicas for the deployment.
                          format: int32
                          type: integer
                      required:
                      - min
                      - max
                      type: object
                    trigger:
                      description: Threshold which will trigger autoscaling events.
                      properties:
                        cpu:
                          description: CPU threshold which will trigger autoscaling
                            events.
                          format: int32
                          type: integer
                      required:
                      - cpu
                      type: object
                  required:
                  - trigger
                  - replicas
                  type: object
                image:
                  description: Image which will be rolled out for the deployment.
                  type: string
                port:
                  description: Port which PHP-FPM is running on.
                  format: int32
                  type: integer
                readOnly:
                  description: Marks the filesystem as readonly to ensure code cannot
                    be changed.
                  type: boolean
                resources:
                  description: Resource constraints which will be applied to the deployment.
                  type: object
              required:
              - image
              - port
              - readOnly
              - resources
              - autoscaling
              type: object
            mysql:
              description: Database provisioned as part of the application eg. "default"
                and "migrate".
              type: object
            newrelic:
              description: NewRelic configuration for performance and debugging.
              properties:
                configmap:
                  description: ConfigMap which contains New Relic configuration.
                  properties:
                    enabled:
                      description: Key which determines if New Relic is enabled.
                      type: string
                    name:
                      description: Name of the New Relic application.
                      type: string
                  required:
                  - enabled
                  - name
                  type: object
                secret:
                  description: Secret which contains New Relic configuration.
                  properties:
                    license:
                      description: License (API Key) for interacting with New Relic.
                      type: string
                  required:
                  - license
                  type: object
              required:
              - configmap
              - secret
              type: object
            nginx:
              description: Configuration for the Nginx deployment eg. image / resources
                / scaling.
              properties:
                autoscaling:
                  description: Autoscaling rules which will be applied to the deployment.
                  properties:
                    replicas:
                      description: How many copies of the deployment which should
                        be running.
                      properties:
                        max:
                          description: Maximum number of replicas for the deployment.
                          format: int32
                          type: integer
                        min:
                          description: Minimum number of replicas for the deployment.
                          format: int32
                          type: integer
                      required:
                      - min
                      - max
                      type: object
                    trigger:
                      description: Threshold which will trigger autoscaling events.
                      properties:
                        cpu:
                          description: CPU threshold which will trigger autoscaling
                            events.
                          format: int32
                          type: integer
                      required:
                      - cpu
                      type: object
                  required:
                  - trigger
                  - replicas
                  type: object
                hostAlias:
                  description: HostAlias which connects Nginx to the FPM service.
                  properties:
                    fpm:
                      description: HostAlias for the PHP FPM service.
                      type: string
                  required:
                  - fpm
                  type: object
                image:
                  description: Image which will be rolled out for the deployment.
                  type: string
                port:
                  description: Port which Nginx is running on.
                  format: int32
                  type: integer
                readOnly:
                  description: Marks the filesystem as readonly to ensure code cannot
                    be changed.
                  type: boolean
                resources:
                  description: Resource constraints which will be applied to the deployment.
                  type: object
              required:
              - image
              - port
              - readOnly
              - resources
              - autoscaling
              - hostAlias
              type: object
            prometheus:
              description: Prometheus configuration for https://www.drupal.org/project/prometheus_exporter.
              properties:
                token:
                  description: Token which Prometheus uses to access https://www.drupal.org/project/prometheus_exporter
                  type: string
              required:
              - token
              type: object
            secret:
              description: Secrets which are exposed to the Drupal application eg.
                database credentials.
              properties:
                default:
                  description: Secrets which are automatically set.
                  properties:
                    path:
                      description: Path which the secrets will be mounted.
                      type: string
                  required:
                  - path
                  type: object
                override:
                  description: Secrets which are user provided.
                  properties:
                    path:
                      description: Path which the secrets will be mounted.
                      type: string
                  required:
                  - path
                  type: object
              required:
              - default
              - override
              type: object
            smtp:
              description: SMTP configuration for outbound email.
              properties:
                from:
                  description: Configuration for validationing FROM addresses.
                  properties:
                    address:
                      description: Address which an application is allowed to send
                        from.
                      type: string
                  required:
                  - address
                  type: object
              required:
              - from
              type: object
            volume:
              description: Volumes which are provisioned for the Drupal application.
              properties:
                private:
                  description: Private filesystem which is only mounted into the PHP-FPM
                    deployment.
                  properties:
                    amount:
                      description: Amount of storage which will be provisioned.
                      type: string
                    class:
                      description: StorageClass which will be used to provision storage.
                      type: string
                    path:
                      description: Path which the volume will be mounted.
                      type: string
                    permissions:
                      description: Permmissions which will be enforced for this volume.
                      properties:
                        cronJob:
                          description: CronJob which will be run to enforce permissions.
                          properties:
                            deadline:
                              description: How long before a Job should be marked
                                as failed if it does not get scheduled in time.
                              format: int64
                              type: integer
                            image:
                              description: Privileged image which will be used when
                                running chown and chmod commands. Needs be an image
                                which runs as root to enforce permissions.
                              type: string
                            keepFailed:
                              description: How many past failures to keep.
                              format: int32
                              type: integer
                            keepSuccess:
                              description: How many past successes to keep.
                              format: int32
                              type: integer
                            readOnly:
                              description: Make the root filesystem of this image
                                ready only.
                              type: boolean
                            retries:
                              description: How many times to get a "Successful" execution
                                before failing.
                              format: int32
                              type: integer
                            schedule:
                              description: Schedule which permissions will be checked.
                              type: string
                          required:
                          - image
                          - schedule
                          type: object
                        directory:
                          description: Directory chmod which will be applied to the
                            volume.
                          format: int64
                          type: integer
                        file:
                          description: File chmod which will be applied to the volume.
                          format: int64
                          type: integer
                        group:
                          description: Group name which will be enforced for the volume.
                            Can also be a GID.
                          type: string
                        user:
                          description: User name which will be enforced for the volume.
                            Can also be a UID.
                          type: string
                      required:
                      - user
                      - group
                      - directory
                      - file
                      - cronJob
                      type: object
                  required:
                  - path
                  - class
                  - amount
                  - permissions
                  type: object
                public:
                  description: Public filesystem which is mounted into the Nginx and
                    PHP-FPM deployments.
                  properties:
                    amount:
                      description: Amount of storage which will be provisioned.
                      type: string
                    class:
                      description: StorageClass which will be used to provision storage.
                      type: string
                    path:
                      description: Path which the volume will be mounted.
                      type: string
                    permissions:
                      description: Permmissions which will be enforced for this volume.
                      properties:
                        cronJob:
                          description: CronJob which will be run to enforce permissions.
                          properties:
                            deadline:
                              description: How long before a Job should be marked
                                as failed if it does not get scheduled in time.
                              format: int64
                              type: integer
                            image:
                              description: Privileged image which will be used when
                                running chown and chmod commands. Needs be an image
                                which runs as root to enforce permissions.
                              type: string
                            keepFailed:
                              description: How many past failures to keep.
                              format: int32
                              type: integer
                            keepSuccess:
                              description: How many past successes to keep.
                              format: int32
                              type: integer
                            readOnly:
                              description: Make the root filesystem of this image
                                ready only.
                              type: boolean
                            retries:
                              description: How many times to get a "Successful" execution
                                before failing.
                              format: int32
                              type: integer
                            schedule:
                              description: Schedule which permissions will be checked.
                              type: string
                          required:
                          - image
                          - schedule
                          type: object
                        directory:
                          description: Directory chmod which will be applied to the
                            volume.
                          format: int64
                          type: integer
                        file:
                          description: File chmod which will be applied to the volume.
                          format: int64
                          type: integer
                        group:
                          description: Group name which will be enforced for the volume.
                            Can also be a GID.
                          type: string
                        user:
                          description: User name which will be enforced for the volume.
                            Can also be a UID.
                          type: string
                      required:
                      - user
                      - group
                      - directory
                      - file
                      - cronJob
                      type: object
                  required:
                  - path
                  - class
                  - amount
                  - permissions
                  type: object
                temporary:
                  description: Temporary filesystem which is only mounted into the
                    PHP-FPM deployment.
                  properties:
                    amount:
                      description: Amount of storage which will be provisioned.
                      type: string
                    class:
                      description: StorageClass which will be used to provision storage.
                      type: string
                    path:
                      description: Path which the volume will be mounted.
                      type: string
                    permissions:
                      description: Permmissions which will be enforced for this volume.
                      properties:
                        cronJob:
                          description: CronJob which will be run to enforce permissions.
                          properties:
                            deadline:
                              description: How long before a Job should be marked
                                as failed if it does not get scheduled in time.
                              format: int64
                              type: integer
                            image:
                              description: Privileged image which will be used when
                                running chown and chmod commands. Needs be an image
                                which runs as root to enforce permissions.
                              type: string
                            keepFailed:
                              description: How many past failures to keep.
                              format: int32
                              type: integer
                            keepSuccess:
                              description: How many past successes to keep.
                              format: int32
                              type: integer
                            readOnly:
                              description: Make the root filesystem of this image
                                ready only.
                              type: boolean
                            retries:
                              description: How many times to get a "Successful" execution
                                before failing.
                              format: int32
                              type: integer
                            schedule:
                              description: Schedule which permissions will be checked.
                              type: string
                          required:
                          - image
                          - schedule
                          type: object
                        directory:
                          description: Directory chmod which will be applied to the
                            volume.
                          format: int64
                          type: integer
                        file:
                          description: File chmod which will be applied to the volume.
                          format: int64
                          type: integer
                        group:
                          description: Group name which will be enforced for the volume.
                            Can also be a GID.
                          type: string
                        user:
                          description: User name which will be enforced for the volume.
                            Can also be a UID.
                          type: string
                      required:
                      - user
                      - group
                      - directory
                      - file
                      - cronJob
                      type: object
                  required:
                  - path
                  - class
                  - amount
                  - permissions
                  type: object
              required:
              - public
              - private
              - temporary
              type: object
          required:
          - nginx
          - fpm
          - exec
          - volume
          - mysql
          - cron
          - configmap
          - secret
          - newrelic
          - smtp
          - backup
          - prometheus
          type: object
        status:
          properties:
            backup:
              description: Backup status.
              properties:
                lastScheduleTime:
                  format: date-time
                  type: string
                name:
                  type: string
              type: object
            configmap:
              description: Configuration status.
              properties:
                default:
                  description: Status of the generated configuration.
                  properties:
                    count:
                      description: How many configuration are assigned to the application.
                      format: int64
                      type: integer
                    name:
                      description: Name of the configmap.
                      type: string
                  type: object
                override:
                  description: Status of the user provided configuration.
                  properties:
                    count:
                      description: How many configuration are assigned to the application.
                      format: int64
                      type: integer
                    name:
                      description: Name of the configmap.
                      type: string
                  type: object
              type: object
            cron:
              description: Background task information eg. Last execution.
              type: object
            exec:
              description: Execution environment status.
              properties:
                name:
                  description: Name of the command line environment template.
                  type: string
              type: object
            fpm:
              description: Status for the PHP-FPM deployment.
              properties:
                image:
                  description: Current image which has been rolled out.
                  type: string
                metrics:
                  description: Application metrics.
                  properties:
                    cpu:
                      description: Current CPU metric for the PHP-FPM deployment.
                      format: int32
                      type: integer
                  type: object
                phase:
                  description: Current phase of the PHP-FPM deployment eg. InProgress.
                  type: string
                replicas:
                  description: Current number of replicas.
                  format: int32
                  type: integer
                service:
                  description: Service for routing traffic.
                  type: string
              type: object
            labels:
              description: Labels for querying Drupal services.
              properties:
                all:
                  description: Used to query all Drupal application pods.
                  type: object
                cron:
                  description: Used to query all background task pods.
                  type: object
                fpm:
                  description: Used to query all PHP-FPM pods.
                  type: object
                nginx:
                  description: Used to query all Nginx pods.
                  type: object
              type: object
            mysql:
              description: MySQL status information.
              type: object
            nginx:
              description: Status for the Nginx deployment.
              properties:
                image:
                  description: Current image which has been rolled out.
                  type: string
                metrics:
                  description: Application metrics.
                  properties:
                    cpu:
                      description: Current CPU metric for the Nginx deployment.
                      format: int32
                      type: integer
                  type: object
                phase:
                  description: Current phase of the Nginx deployment eg. InProgress.
                  type: string
                replicas:
                  description: Current number of replicas.
                  format: int32
                  type: integer
                service:
                  description: Service for routing traffic.
                  type: string
              type: object
            observedGeneration:
              description: Used for determining if an APIs information is up to date.
              format: int64
              type: integer
            secret:
              description: Secrets status.
              properties:
                default:
                  description: Status of the generated secrets.
                  properties:
                    count:
                      description: How many secrets are assigned to the application.
                      format: int64
                      type: integer
                    name:
                      description: Name of the secret.
                      type: string
                  type: object
                override:
                  description: Status of the user provided secrets.
                  properties:
                    count:
                      description: How many secrets are assigned to the application.
                      format: int64
                      type: integer
                    name:
                      description: Name of the secret.
                      type: string
                  type: object
              type: object
            smtp:
              description: SMTP service status.
              properties:
                verification:
                  properties:
                    address:
                      description: Address which an application is allowed to send
                        from.
                      type: string
                  type: object
              type: object
            volume:
              description: Volume status information.
              properties:
                private:
                  description: Current state of the private filesystem volume.
                  properties:
                    name:
                      description: Name of the volume.
                      type: string
                    phase:
                      description: Current state of the volume.
                      type: string
                  type: object
                public:
                  description: Current state of the public filesystem volume.
                  properties:
                    name:
                      description: Name of the volume.
                      type: string
                    phase:
                      description: Current state of the volume.
                      type: string
                  type: object
                temporary:
                  description: Current state of the temporary filesystem volume.
                  properties:
                    name:
                      description: Name of the volume.
                      type: string
                    phase:
                      description: Current state of the volume.
                      type: string
                  type: object
              type: object
          type: object
  version: v1beta1
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
