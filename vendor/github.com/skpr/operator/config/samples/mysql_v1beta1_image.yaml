apiVersion: mysql.skpr.io/v1beta1
kind: Image
metadata:
  generateName: test
spec:
  connection:
    configmap:
      name: drupal-dev-default
      keys:
        database: mysql.default.database
        hostname: mysql.default.hostname
        port: mysql.default.port
    secret:
      name: drupal-dev-default
      keys:
        username: mysql.default.username
        password: mysql.default.password
  rules:
    sanitize:
      tables:
        # Drupal 7
        - name: users
          fields:
            - name: mail
              value: "SANITIZED_MAIL"
            - name: pass
              value: "SANITIZED_PASSWORD"
        # Drupal 8
        - name: users_field_data
          fields:
            - name: mail
              value: "SANITIZED_MAIL"
            - name: pass
              value: "SANITIZED_PASSWORD"
    nodata:
      - cache*
      - captcha_sessions
      - history
      - flood
      - batch
      - queue
      - sessions
      - semaphore
      - search_api_task
      - search_dataset
      - search_index
      - search_total
  destinations:
    - registry.docker-registry.svc.cluster.local:30050/skpr-project-example/dev:default-latest
    - registry.docker-registry.svc.cluster.local:30050/skpr-project-example/dev:default-2019-07-30